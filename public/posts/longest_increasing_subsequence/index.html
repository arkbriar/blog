<!DOCTYPE html>
<html>

<head>
  <title> Longest Increasing Subsequence &middot; crazy.ark </title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.26" />


<link rel="stylesheet" href="https://blog.crazyark.me/css/vec.css">
<link rel="stylesheet" href="https://blog.crazyark.me/css/github.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/favicon.ico">


<link href="" rel="alternate" type="application/rss+xml" title="crazy.ark" />

</head>

<body>
  <header>
  <nav>
    <ul>
      
      
      <li class="pull-left ">
        <a href="https://blog.crazyark.me/">/home/crazy.ark</a>
      </li>
      
      
      <li class="pull-left ">
        <a href="/about">~/about</a>
      </li>
      
      
      <li class="pull-left ">
        <a href="/contact">~/contact</a>
      </li>
      
      
      <li class="pull-left ">
        <a href="https://ericfu.me">~/external/coding husky</a>
      </li>
      
      
      <li class="pull-left current">
        <a href="/posts">~/posts</a>
      </li>
      
  
      <li class="pull-right"><a href=""><i class="fa fa-rss"></i></a></li>
    </ul>
  </nav>
</header>
  <div class="content">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#algorithms-for-lis">Algorithms for LIS</a>
<ul>
<li><a href="#dp">DP</a></li>
<li><a href="#sort-lcs">Sort + LCS</a></li>
<li><a href="#dp-bs">DP + BS</a></li>
</ul></li>
<li><a href="#atcoder-grand-contest-019c">AtCoder Grand Contest 019C</a></li>
<li><a href="#æ€»ç»“">æ€»ç»“</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    
    <section class="post">
      <h1 class="post-title"><a href="https://blog.crazyark.me/posts/longest_increasing_subsequence/">Longest Increasing Subsequence</a></h1>
      <span class="post-date">Sep 1, 2017 </span>
      <div class="post-content">
        

<p>æœ€é•¿é€’å¢å­åºåˆ—ç®—æ³•ï¼ŒåŸæœ¬ä»¥ä¸ºå·²ç»è®°ä½äº†æœ€å¿«çš„ç®—æ³•ï¼Œçœ‹æ¥æ˜¯è®°æ€§å¤ªå·®ï¼Œä»Šå¤©ç¢°åˆ°ä¸€é“é¢˜ç›®åˆå¿˜è®°äº†æ€ä¹ˆåš ğŸ™„</p>

<p>ä¸‰ç§åšæ³•ï¼šDPï¼ŒSort + LCSï¼ŒDP + BSï¼Œæˆ‘åªè®°å¾—ç¬¬ä¸€ç§DPäº† &hellip;</p>

<p>ç„¶åå’±ä»¬é¡ºä¾¿æŠŠæŸé“é¢˜ç›®åšäº† ğŸ¤£</p>

<h3 id="algorithms-for-lis">Algorithms for LIS</h3>

<h4 id="dp">DP</h4>

<p>å¾ˆæ˜¾ç„¶ï¼Œä»¥ç¬¬iä¸ªå…ƒç´ ä¸ºç»“å°¾çš„æœ€é•¿é€’å¢å­åºåˆ—çš„é•¿åº¦æ˜¯ max{dp[j] + 1}, j &lt;  i &amp;&amp; arr[j] &lt; arr[i]ï¼Œæ‰€ä»¥DPç©ºé—´å¤æ‚åº¦ O(n)ï¼Œæ—¶é—´å¤æ‚åº¦ O(n^2)ã€‚</p>

<pre><code class="language-cpp">int LIS(vector&lt;int&gt; nums) {
    int n = nums.size();
    int dp[n];
    int res = 0;
    for (int i = 0; i &lt; n; ++ i) {
        dp[n] = 1;
        for (int j = 0; j &lt; i; ++ j) {
            if (nums[j] &lt; nums[i]) 
                dp[i] = max(dp[i], dp[j] + 1);
        }
        res = max(res, dp[i]);
    }
    return res;
}
</code></pre>

<h4 id="sort-lcs">Sort + LCS</h4>

<p>åŸæ•°ç»„çš„é€’å¢å­åºåˆ—ä¸€å®šæ˜¯<strong>æ’åºå</strong>æ•°ç»„å’ŒåŸæ¥æ•°ç»„çš„å…¬å…±å­åºåˆ—ï¼Œæ‰€ä»¥æ’å®Œåºæ‰¾æœ€é•¿å…¬å…±å­åºåˆ—å°±è¡Œäº†ã€‚</p>

<p>ç©ºé—´å¤æ‚åº¦ O(n^2)ï¼Œæ—¶é—´å¤æ‚åº¦ O(n^2)ã€‚</p>

<pre><code class="language-cpp">int LCS(vector&lt;int&gt; a, vector&lt;int&gt; b) {
    assert(a.size() == b.size());
    
    int n = a.size();
    int dp[n + 1][n + 1];
    for (int i = 0; i &lt; n; ++ i) {
        for (int j = 0; j &lt; n; ++ j) {
            if (i == 0 || j == 0) 
                dp[i][j] = 0;
            else if (a[i - 1] == b[j - 1]) 
                dp[i][j] = dp[i - 1][j - 1] + 1;
            else dp[i][j] = max(dp[i - 1][j], dp[i][j - 1]);
        }
    }
    return dp[n][n];
}

int LIS(vector&lt;int&gt; nums) {
    auto sorted = nums;
    sort(sorted.begin(), sorted.end());
    return LCS(nums, sorted);
}
</code></pre>

<h4 id="dp-bs">DP + BS</h4>

<p>è¿™æ˜¯æœ€å¿«çš„ä¸€ä¸ªç®—æ³•ï¼Œä¹Ÿæ˜¯æˆ‘åˆ°ç°åœ¨éƒ½è¿˜æ²¡è®°ä½çš„ç®—æ³• ğŸ™„ï¼Œå…³é”®æ€æƒ³ä¸ºç»´æŠ¤ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­ç¬¬lé¡¹(1-based) ä¸ºé•¿åº¦ä¸ºlçš„é€’å¢å­åºåˆ—çš„æœ€å¤§(æœ€å)å…ƒç´ çš„æœ€å°å€¼ï¼Œç„¶åä¸æ–­ç»´æŠ¤è¿™ä¸ªæ•°ç»„ç›´åˆ°ç»“æŸï¼Œæœ€ç»ˆæ•°ç»„çš„æœ‰æ•ˆé•¿åº¦å³ä¸ºLISçš„ç»“æœã€‚</p>

<p>ç”±äºç¬¬lé¡¹ä¸ºé•¿åº¦ä¸ºlçš„é€’å¢å­åºåˆ—çš„æœ€å¤§å…ƒç´ çš„æœ€å°å€¼ï¼Œæ‰€ä»¥è¯¥æ•°ç»„ä¸€å®šä¸ºä¸€ä¸ªé€’å¢æ•°ç»„ã€‚å½“ä¸‹ä¸€ä¸ªæ•°néœ€è¦èƒ½å¤Ÿæˆä¸ºæŸä¸ªé€’å¢å­åºåˆ—çš„ç»“å°¾æ—¶ï¼Œæˆ‘ä»¬åœ¨è¯¥æ•°ç»„ä¸­æŸ¥æ‰¾ç¬¬ä¸€ä¸ªä¸æ¯”nå°çš„æ•°ï¼Œå‡è®¾ä½ç½®ä¸ºlï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±çŸ¥é“æˆ‘ä»¬èƒ½ä»¥nç»“å°¾æ„å»ºä¸€ä¸ªæœ€é•¿ä¸ºlçš„é€’å¢å­åºåˆ— (æƒ³æƒ³ä¸ºä»€ä¹ˆï¼Ÿå¾ˆç®€å•)ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±å°†lä½ç½®çš„æ•°ç»„å€¼æ›´æ–°ä¸ºnã€‚æœ‰ä¸€ä¸ªç‰¹æ®Šæƒ…å†µå³æ•°ç»„ä¸­ä¸å­˜åœ¨ä½ç½®lï¼Œé‚£ä¹ˆå°±åœ¨æ•°ç»„æœ€åæ·»åŠ nã€‚</p>

<p>è¿™é‡ŒæŸ¥æ‰¾å¯ä»¥ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾çš„æ–¹å¼ï¼Œä»è€Œç©ºé—´å¤æ‚åº¦ä¸º O(n)ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(nlgn)ã€‚</p>

<pre><code class="language-cpp">int LIS(vector&lt;int&gt; nums) {
    vector&lt;int&gt; dp;
    for (auto n : nums) {
        auto it = lower_bound(dp.begin(), dp.end(), n);
        if (it == dp.end()) dp.push_back(n);
        else *it = n;
    }
    return dp.size();
}
</code></pre>

<p>å…¶å®æˆ‘å‘ç°&hellip;ï¼Œæˆ‘éƒ½ä¸ç”¨æ‰‹å†™BSï¼ŒSTLè¿˜æ˜¯è§£å†³äº†å¾ˆå¤šé—®é¢˜çš„ï¼Œé™¤äº†æ²¡æœ‰Fibonacci Heapä¹‹å¤–æ„Ÿè§‰å¥½åƒä¹Ÿæ²¡å•¥ç¼ºç‚¹äº† (ç¬‘</p>

<h3 id="atcoder-grand-contest-019c">AtCoder Grand Contest 019C</h3>

<p>é¢˜ç›®ï¼š</p>

<blockquote>
<p>In the city of Nevermore, there are 10e8 streets and 10e8 avenues, both numbered from 0 to 10e8 âˆ’ 1. All streets run straight from west to east, and all avenues run straight from south to north. The distance between neighboring streets and between neighboring avenues is exactly 100 meters.
Every street intersects every avenue. Every intersection can be described by pair (x,y), where x is avenue ID and y is street ID.</p>

<p>There are N fountains in the city, situated at intersections (Xi,Yi). Unlike normal intersections, there&rsquo;s a circle with radius 10 meters centered at the intersection, and there are no road parts inside this circle.
The picture below shows an example of how a part of the city with roads and fountains may look like.</p>
</blockquote>

<p><img src="/img/posts/1f931bf0c98ec6f07e612b0282cdb094.png" alt="city" /></p>

<p>çº¦æŸ:</p>

<blockquote>
<ul>
<li>0â‰¤x1,y1,x2,y2&lt;10e8</li>
<li>1â‰¤Nâ‰¤200,000</li>
<li>0â‰¤Xi,Yi&lt;10e8</li>
<li>Xiâ‰ Xj for iâ‰ j</li>
<li>Yiâ‰ Yj for iâ‰ j</li>
<li>Intersections (x1,y1) and (x2,y2) are different and don&rsquo;t contain fountains.</li>
<li>All input values are integers.</li>
</ul>
</blockquote>

<p>è¾“å…¥:</p>

<blockquote>
<p>x1 y1 x2 y2
N
X1 Y1
X2 Y2
:
XN YN</p>
</blockquote>

<p>è¾“å‡º:</p>

<blockquote>
<p>Print the shortest possible distance one needs to cover in order to get from intersection (x1,y1) to intersection (x2,y2), in meters. Your answer will be considered correct if its absolute or relative error doesn&rsquo;t exceed 10eâˆ’11.</p>
</blockquote>

<p>Samples:</p>

<blockquote>
<p>I: 1 1 6 5
3
3 2
5 3
2 4</p>

<p>O: 891.415926535897938</p>
</blockquote>

<p><br/></p>

<blockquote>
<p>I: 3 5 6 4
3
3 2
5 3
2 4</p>

<p>O: 400.000000000000000</p>
</blockquote>

<p><br/></p>

<blockquote>
<p>I: 4 2 2 2
3
3 2
5 3
2 4</p>

<p>O: 211.415926535897938</p>
</blockquote>

<p>Okï¼Œä¸€ä¸ªç½‘æ ¼ç»™å®šä¸¤ä¸ªç‚¹ï¼Œé‚£ä¹ˆä¸è€ƒè™‘å–·æ³‰çš„èµ°æ³•æ˜¯å›ºå®šçš„ï¼Œé•¿åº¦ä¸º abs(x1 - x2) + abs(y1 - y2)ã€‚</p>

<p>ç”±å¯¹ç§°æ€§ï¼Œæˆ‘ä»¬ä¸å¦¨è®¾ x1 &lt;= x2, y1 &lt;= y2ï¼Œè€ƒè™‘å–·æ³‰çš„æƒ…å†µä¸‹ï¼Œä»å–·æ³‰å¤„è½¬è§’èƒ½å¤Ÿå°‘èµ°ä¸€äº›è·¯ï¼Œè€Œç›´èµ°ç»è¿‡å–·æ³‰ä¼šå¤šèµ°ä¸€äº›è·¯ã€‚</p>

<p>å‡è®¾æˆ‘ä»¬çš„èµ°æ³•æ˜¯ç»•è¿œè·¯è´ªè½¬è§’å°‘èµ°ï¼Œæˆ–æ˜¯é¿å…ç›´èµ°ï¼Œå³èµ°å‡º{(x1, y1), (x2, y2)}æ‰€æ„æˆçš„çŸ©å½¢çš„æƒ…å†µï¼Œç”±äºæ¯è¡Œæ¯åˆ—ä»…æœ‰ä¸€ä¸ªå–·æ³‰ï¼Œæ‰€ä»¥å¤šè¿œç¦»çŸ©å½¢ä¸€æ ¼ä¼šå¯¼è‡´å¤šèµ°200mï¼Œè€Œæœ€å¤šåªèƒ½å°‘èµ° (2 * r - pi * r / 2) å¤§çº¦ä¸º4.5mçš„è·ç¦»ï¼Œæˆ–è€…å°‘èµ°(pi * r - 2 * r) å¤§çº¦ä¸º 11.4m çš„è·ç¦»ï¼Œæ‰€ä»¥æ˜¾ç„¶æ˜¯ä¸å¯èƒ½çš„ã€‚</p>

<p>æ‰€ä»¥èµ°æ³•ä¸€å®šæ˜¯åœ¨{(x1, y1), (x2, y2)}çŸ©å½¢å†…éƒ¨ï¼Œè´ªæœ€å¤šçš„è½¬è§’ã€‚</p>

<p>æ˜¾ç„¶ï¼Œåœ¨ (x1, y1) åˆ° (x2, y2) çš„è·¯ç¨‹ä¸­ï¼Œæœ€å¤šåªæœ‰ c = min(x2 - x1, y2 - y1) æ¬¡è½¬è§’ï¼Œæœ€å¤šæœ‰ c + 1 ä¸ªå–·æ³‰ã€‚</p>

<p>å‡è®¾å–·æ³‰æ˜¯æŒ‰ç…§xçš„å¤§å°è¿›è¡Œæ’åˆ—çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½è¿‡çš„æœ€å¤šçš„æ¸©æ³‰ç­‰äºæ¸©æ³‰yå€¼æ•°ç»„çš„æœ€é•¿é€’å¢å­åºåˆ—ï¼Œå‡è®¾é•¿åº¦ä¸ºkã€‚</p>

<p>é‚£ä¹ˆæœ‰ä¸¤ç§æƒ…å†µï¼Œ</p>

<ol>
<li>k &lt;= c, é‚£ä¹ˆå°±ä¸€å®šæœ‰ä¸€ç§èµ°æ³•ï¼Œä½¿å¾—æˆ‘ä»¬ç»è¿‡è¿™ä¸ªå­åºåˆ—ä¸­æ¯ä¸ªæ¸©æ³‰çš„æ—¶å€™éƒ½æ˜¯è½¬è§’</li>
<li>k == c + 1ï¼Œé‚£ä¹ˆä¸€å®šå­˜åœ¨ä¸€ä¸ªå–·æ³‰éœ€è¦ç»è¿‡ï¼Œæ‰€ä»¥èµ°æ³•æ˜¯èµ°cä¸ªè§’ï¼Œå¹¶ç»è¿‡å‰©ä½™çš„ä¸€ä¸ªã€‚</li>
</ol>

<p>æ‰€ä»¥å…³é”®å³æ±‚æœ€é•¿é€’å¢å­åºåˆ—ï¼Œæ”¾ä»£ç </p>

<pre><code class="language-cpp">#include &lt;bits/stdc++.h&gt;

using namespace std;

pair&lt;long long, long long&gt; p[200000];

const double PI = 3.14159265358979323846;
const double R = 10.0;
const double quarter_circle = PI * R / 2;
const double edge = 100.0;

using PLL = pair&lt;long long, long long&gt;;
int dp[200000];

int main() {
    long long x1, y1, x2, y2;
    scanf(&quot;%lld %lld %lld %lld&quot;, &amp;x1, &amp;y1, &amp;x2, &amp;y2);

    if (x1 &gt; x2) {
        swap(x1, x2);
        swap(y1, y2);
    }

    long long y_min = min(y1, y2), y_max = max(y1, y2);

    // drop those not used
    int n;
    scanf(&quot;%d&quot;, &amp;n);
    for (int i = 0; i &lt; n;) {
        scanf(&quot;%lld %lld&quot;, &amp;p[i].first, &amp;p[i].second);
        if (p[i].first &lt; x1 || p[i].first &gt; x2 || p[i].second &lt; y_min || p[i].second &gt; y_max) {
            n--;
        } else {
            ++i;
        }
    }

    // x1 &lt;= x2
    double res = edge * (x2 - x1 + y_max - y_min);
    sort(p, p + n, [&amp;](const PLL&amp; a, const PLL&amp; b) { return a.first &lt; b.first; });
    if (y1 &gt; y2) {
        for (int i = 0; i &lt; n; ++i) {
            p[i].second = -p[i].second;
        }
    }

    int len = 0;
    for (int i = 0; i &lt; n; ++i) {
        auto it = lower_bound(dp, dp + len, p[i].second);
        *it = p[i].second;
        if (it == dp + len) {
            len ++;
        }
    }

    int max_corner = min(x2 - x1, y_max - y_min);

    if (len &lt; max_corner + 1)
        res += len * (quarter_circle - 2 * R);
    else
        res += max_corner * (quarter_circle - 2 * R) + (2 * quarter_circle - 2 * R);

    printf(&quot;%.15f\n&quot;, res);

    return 0;
}
</code></pre>

<h3 id="æ€»ç»“">æ€»ç»“</h3>

<p>ä¸€å¤©ä¸åˆ·é¢˜å°±ä¼šå¿˜è®°ç®—æ³•ï¼Œè¿˜æœ‰ atcoder çš„é¢˜è¿˜çœŸæ˜¯éš¾&hellip;</p>

      </div>
    </section>
    
    <section class="pagination clearfix">
      
      <a class="btn previous " href="https://blog.crazyark.me/posts/cpp_sigfpe/"> SIGFPE When Doing DivQ </a> 
       
      
    </section>
    
    
<section id="disqus_thread" class='disqus'></section>
<script>
  var disqus_config = function () {
    this.page.url = "https://blog.crazyark.me/posts/longest_increasing_subsequence/";
    
  };
  (function() {
    var d = document, s = d.createElement('script');
    s.src = '//crazyark.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

  </div>
  
  <footer>
  <div class="footer-info">
    <p>
      <a href="mailto:arkbriar@gmail.com?subject="><i class="fa fa-envelope-o"></i> arkbriar@gmail.com </a>
      {
        <a href="https://gohugo.io/" title="Hugo :: A fast and modern static website engine">Hugo 0.26</a>,
        <a href="https://github.com/IvanChou/yii.im" title="vec">Vec</a> 
      }
      {<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/" title="CC BY-NC-ND 3.0">CC BY-NC-ND 3.0</a>}
    </p>
  </div>
</footer>

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

<style type="text/css" media="screen">
  code.has-jax {
    font: inherit;
    font-size: 100%;
    background: inherit;
    border: inherit;
    color: #515151;
}
</style>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    // Fix <code> tags after MathJax finishes running. This is a
    // hack to overcome a shortcoming of Markdown. Discussion at
    // https://github.com/mojombo/jekyll/issues/199
    var all = MathJax.Hub.getAllJax();
    all.forEach(function(e) {
        e.SourceElement().parentNode.className += ' has-jax';
    });
});
</script>

  
  <script src="https://blog.crazyark.me/js/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  

</body>

</html>
